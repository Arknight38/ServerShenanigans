# File Sharing System

A high-performance peer-to-peer file sharing system with support for compression, resumable downloads, SHA256 checksums, and automatic retry capabilities.
Be careful when reading this README, I only gave a quick one over to the autogenerated README

## Overview

This system consists of two components:
- **Server**: Shares files from a local machine over the network
- **Client**: Connects to servers and downloads shared files

## Features

### Server Features
- Share individual files or entire folders
- Automatic SHA256 checksum generation
- Configurable compression using zlib
- Multiple concurrent client connections
- Auto-load shared folders on startup
- Tab completion for file paths
- Persistent configuration

### Client Features
- Resume interrupted downloads
- Optional compression support
- SHA256 checksum verification
- Progress bar with transfer speed
- Configurable download folder
- Connection history
- Persistent settings

## System Requirements

### Windows
- Windows 10 or later
- Visual Studio 2019 or later (for compilation)
- Winsock2 library
- OpenSSL library
- zlib library

### Required Libraries
- **Winsock2**: Network communication (included with Windows SDK)
- **OpenSSL**: SHA256 hashing (`libcrypto.lib`)
- **zlib**: Data compression (`zlib.lib`)

## Installation

#### Compilation

**Server:**
```bash
g++ -std=c++17 server.cpp -o server.exe -lws2_32 -lz -lcrypto
```

**Client:**
```bash
g++ -std=c++17 client.cpp -o client.exe -lws2_32 -lz -lcrypto
```

## Usage

### Server Setup

#### Starting the Server
```bash
server.exe
```

The server will start on the default port (8080) and display:
- Local IP address
- Port number
- Compression status
- Maximum connections allowed

#### Server Commands

**Share a single file:**
```
> add C:\path\to\file.txt
```
Use TAB to autocomplete file paths.

**Share an entire folder:**
```
> addfolder C:\path\to\folder
```
Recursively shares all files in the folder. Use TAB to autocomplete folder paths.

**List shared files:**
```
> list
```

**Remove a shared file:**
```
> remove filename.txt
```

**Set auto-share folder:**
```
> setfolder C:\path\to\folder
```
This folder will be automatically loaded when the server starts.

**Toggle compression:**
```
> compress on
> compress off
```

**Exit server:**
```
> quit
```

#### Configuration File

The server creates `server_config.txt` with the following settings:
```ini
port=8080
compression=true
max_connections=50
shared_folder=C:\path\to\shared
```

You can manually edit this file before starting the server.

### Client Setup

#### Starting the Client
```bash
client.exe [server_ip] [port]
```

Example:
```bash
client.exe 192.168.1.100 8080
```

If no arguments are provided, the client loads the last used server from configuration.

#### Client Menu Options

**1. Connect to server**
- Enter server IP address
- Enter port (default: 8080)
- Tests connection immediately

**2. List available files**
- Retrieves and displays all files shared by the server
- Shows file sizes and partial SHA256 checksums

**3. Download file by number**
- Select a file from the list by its index number
- Automatically saves to the configured download folder

**4. Download file by name**
- Enter the exact filename
- Optionally specify a different save name

**5. Set download folder**
- Change where downloaded files are saved
- Creates the folder if it does not exist

**6. Toggle compression**
- Enable or disable compression for downloads
- Note: Resume functionality is disabled when compression is enabled

**7. Show settings**
- Display current server connection and compression status

**8. Exit**
- Close the client application

#### Configuration File

The client creates `client_config.txt` with the following settings:
```ini
server=192.168.1.100
port=8080
compression=true
download_folder=C:\Downloads
```

## Protocol Specification

### Request Format

**LIST** - Request list of shared files
```
LIST
```

**GET** - Download a file
```
GET filename [OFFSET offset] [COMPRESS]
```

**CHECKSUM** - Request file checksum
```
CHECKSUM filename
```

### Response Format

**LIST Response:**
```
Available files:
filename:size:sha256
filename2:size2:sha256
```

**GET Response:**
```
OK:size:mode
[binary data]
```

**Error Response:**
```
ERROR: message
```

## Network Configuration

### Firewall Settings

Ensure the server port (default: 8080) is allowed through your firewall:

**Windows Firewall:**
1. Open Windows Defender Firewall
2. Click "Advanced settings"
3. Select "Inbound Rules"
4. Click "New Rule"
5. Select "Port" and click Next
6. Enter port number (8080) and click Next
7. Allow the connection
8. Apply to all profiles
9. Name the rule (e.g., "File Sharing Server")

### Router Port Forwarding

For external access, configure port forwarding on your router:
1. Access your router's admin panel
2. Navigate to Port Forwarding settings
3. Forward external port 8080 to your server's local IP
4. Set protocol to TCP

### Finding Your IP Address

**Local Network IP:**
The server displays this automatically on startup.

**External IP:**
Visit a service like `whatismyip.com` to find your public IP address for external connections.

## Advanced Usage

### Resume Downloads

The client automatically resumes interrupted downloads:
1. If a download is interrupted, the partial file is saved
2. On the next download attempt, the client requests only the remaining bytes
3. The server sends data starting from the specified offset

**Important:** Resume is disabled when compression is enabled. Partial files will be deleted when starting a compressed download.

### Compression

Compression reduces bandwidth usage but increases CPU usage:

**When to enable:**
- Slow network connections
- Text files, source code, documents
- Large file transfers

**When to disable:**
- Already compressed files (ZIP, JPEG, MP4)
- Fast local network transfers
- CPU-constrained systems

### Checksum Verification

The client automatically verifies SHA256 checksums after download:
- Prevents corrupted downloads
- Detects transmission errors
- Ensures file integrity

If verification fails, delete the file and download again.

## Troubleshooting

### Server Issues

**"Bind failed" error:**
- Port is already in use by another application
- Change port in `server_config.txt`
- Or close the application using that port

**"Cannot open file" error:**
- File was deleted or moved after sharing
- Use `list` command to verify shared files
- Re-add the file using `add` command

**Clients cannot connect:**
- Check firewall settings
- Verify server IP address
- Ensure server is running
- Test with `telnet server_ip port`

### Client Issues

**"Connection failed" error:**
- Server is not running
- Incorrect IP address or port
- Firewall blocking connection
- Network connectivity issues

**"Download failed" error:**
- Network interruption
- Server stopped during transfer
- Insufficient disk space
- File permissions issue

**Checksum verification fails:**
- Download was corrupted
- Network transmission error
- Delete file and download again
- Disable compression and retry

**Cannot resume download:**
- Compression is enabled (resume not supported with compression)
- Disable compression to enable resume functionality
- Partial file will be deleted automatically

## Performance Optimization

### Network Performance

**Adjust chunk size** (requires recompilation):
- Default: 64KB chunks
- Increase for faster networks (128KB, 256KB)
- Decrease for unstable connections (32KB)

**Concurrent connections:**
- Default: 50 maximum connections
- Adjust in `server_config.txt`
- Lower for limited bandwidth
- Higher for powerful servers

### Compression Settings

**Server-side:**
- Uses `Z_BEST_SPEED` compression level
- Balances speed and compression ratio
- Modify `compressData()` for different levels

**Compression ratios:**
- Text files: 50-70% reduction
- Source code: 60-80% reduction
- Binary files: 0-20% reduction
- Already compressed: No benefit

## Security Considerations

### Data Integrity
- SHA256 checksums verify file integrity
- Automatic verification after each download
- Protects against transmission errors

### Network Security
- No authentication implemented
- No encryption for data transfer
- Intended for trusted networks only

**For production use, consider:**
- Implementing TLS/SSL encryption
- Adding user authentication
- Using VPN for remote access
- Restricting IP addresses

## File Structure

```
project/
├── server.cpp              # Server source code
├── client.cpp              # Client source code
├── server.exe              # Compiled server (after build)
├── client.exe              # Compiled client (after build)
├── server_config.txt       # Server configuration (auto-generated)
├── client_config.txt       # Client configuration (auto-generated)
├── .resume/                # Resume data directory (client)
└── README.md               # This file
```

## Technical Details

### Dependencies
- **C++ Standard**: C++17 or later
- **Filesystem library**: std::filesystem
- **Threading**: std::thread, std::mutex, std::atomic
- **Network**: Winsock2 (Windows sockets)
- **Hashing**: OpenSSL EVP API
- **Compression**: zlib

### Memory Usage
- 64KB buffer per active transfer
- Additional memory for compression buffers
- Minimal memory for file metadata

### Network Protocol
- TCP/IP for reliable data transfer
- Custom application-level protocol
- Binary data transmission with text headers

## Known Limitations

1. **Platform Support**: Windows only (uses Winsock2 and `conio.h`)
2. **Resume with Compression**: Cannot resume compressed downloads
3. **Authentication**: No user authentication system
4. **Encryption**: No data encryption during transfer
5. **Large Files**: Limited by available memory for hash calculation
6. **Unicode**: Limited support for non-ASCII filenames

## Future Enhancements

Possible improvements for future versions:
- Cross-platform support (Linux, macOS)
- TLS/SSL encryption
- User authentication system
- GUI interface
- Torrent-style multi-source downloads
- Bandwidth throttling
- Upload functionality from client
- SQLite database for file metadata
- Web interface for management

## License

This software is provided as-is without any warranty. Use at your own risk.

## Support

For issues, questions, or contributions:
- Check the troubleshooting section
- Review the protocol specification
- Verify network configuration
- Test with minimal firewall settings

## Version History

**Version 2.0**
- Added compression support
- Implemented resumable downloads
- Added SHA256 checksum verification
- Tab completion for file paths
- Persistent configuration
- Progress bar with transfer speed
- Multiple concurrent connections

**Version 1.0**
- Basic file sharing functionality
- LIST and GET commands
- Simple client-server architecture